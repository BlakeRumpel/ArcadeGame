"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var levelInfo=document.querySelector(".level-info"),levelText=document.querySelector(".level-info .level"),flavorText=document.querySelector(".level-info .flavor"),statLevelText=document.querySelector(".stats .level"),statHighScoreText=document.querySelector(".stats .high-score"),statDeathsText=document.querySelector(".stats .deaths"),lockPlayer=!1,level=1,highScore=1,deaths=0,prevHighScore=0,randInt=function(e,t){return Math.floor(Math.random()*(t-e))+e},showText=function(){levelText.textContent="Level "+level,flavorText.textContent="Don't touch the bugs.",levelInfo.style.display="unset",lockPlayer=!0,setTimeout(function(){levelInfo.style.display="none",lockPlayer=!1},2e3)},setStats=function(e){statLevelText.textContent="Level "+level,statHighScoreText.textContent="High Score: "+highScore,statDeathsText.textContent="Deaths: "+deaths},Enemy=function(){function n(e,t){_classCallCheck(this,n),this.sprite="images/enemy-bug.png",this.speed=randInt(300,800),this.x=randInt(e,this.speed),this.y=t}return _createClass(n,[{key:"addSpeed",value:function(){this.speed+=randInt(30,80),this.x=randInt(this.x,this.speed)}},{key:"update",value:function(e){this.x>player.getX()-61&&this.x<player.getX()+41&&this.y===player.getY()&&die(),this.x+=this.speed*e,505<this.x&&(this.x=randInt(-400,-100))}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)}}]),n}(),Player=function(){function e(){_classCallCheck(this,e),this.sprite="images/char-cat-girl.png",this.row=1,this.column=3}return _createClass(e,[{key:"getX",value:function(){return 101*(5-this.column)}},{key:"getY",value:function(){return 83*(6-this.row)-41}},{key:"respawn",value:function(){this.row=1,this.column=3}},{key:"update",value:function(){}},{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.getX(),this.getY())}},{key:"handleInput",value:function(e){if(!lockPlayer)switch(e){case"up":player.row<6&&(player.row++,6===player.row&&levelUp());break;case"down":1<player.row&&player.row--;break;case"left":player.column<5&&player.column++;break;case"right":1<player.column&&player.column--}}}]),e}(),allEnemies=[new Enemy(0,42),new Enemy(0,125),new Enemy(0,208)],player=new Player,levelUp=function(){highScore<++level&&(highScore=level),player.respawn(),showText(),setStats(),allEnemies.forEach(function(e){return e.addSpeed()})},die=function(){level=1,deaths++,player.respawn(),allEnemies.forEach(function(e){e.speed=randInt(300,500),e.x=randInt(e.x,e.speed)}),levelText.textContent="You died!",flavorText.textContent=prevHighScore<highScore?"You got a new high score!":"That's the way it goes!",levelInfo.style.display="unset",lockPlayer=!0,prevHighScore<highScore&&(prevHighScore=highScore),setTimeout(showText,2500),setStats()};document.addEventListener("keyup",function(e){player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])}),showText();var Engine=function(e){var n,t=e.document,r=e.window,a=t.createElement("canvas"),o=a.getContext("2d");function s(){var t,e=Date.now();t=(e-n)/1e3,allEnemies.forEach(function(e){e.update(t)}),player.update(),function(){var e,t,n=["images/water-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/grass-block.png","images/grass-block.png"];for(o.clearRect(0,0,a.width,a.height),e=0;e<6;e++)for(t=0;t<5;t++)o.drawImage(Resources.get(n[e]),101*t,83*e);allEnemies.forEach(function(e){e.render()}),player.render()}(),n=e,r.requestAnimationFrame(s)}a.width=505,a.height=606,t.body.appendChild(a),Resources.load(["images/stone-block.png","images/water-block.png","images/grass-block.png","images/enemy-bug.png","images/char-cat-girl.png"]),Resources.onReady(function(){n=Date.now(),s()}),e.ctx=o}(void 0);!function(){var n={},r=[];function t(e){if(n[e])return n[e];var t=new Image;t.onload=function(){n[e]=t,a()&&r.forEach(function(e){e()})},n[e]=!1,t.src=e}function a(){var e=!0;for(var t in n)n.hasOwnProperty(t)&&!n[t]&&(e=!1);return e}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)},get:function(e){return n[e]},onReady:function(e){r.push(e)},isReady:a}}();